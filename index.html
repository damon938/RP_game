<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carte Joueur RPG - Debug</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Poppins', sans-serif; background: #1a1a1a; color: #eee; padding: 20px; }
  h1 { text-align: center; font-family: 'Cinzel Decorative', serif; font-size: 2.5em; color: #ffd700; }
  .input-container { text-align: center; margin-bottom: 20px; }
  input, button { padding: 10px; font-size: 16px; border-radius: 5px; border: none; }
  input { width: 200px; margin-right: 10px; }
  button { background: #4CAF50; color: #fff; cursor: pointer; }
  #error { color: #ff4d4d; text-align: center; margin-bottom: 10px; }

  .player-card {
    background: #2a2a2a; 
    padding: 20px; 
    border-radius: 15px; 
    max-width: 750px; 
    margin: 0 auto; 
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
  }
  .player-card h2 { text-align: center; font-family: 'Cinzel Decorative', serif; color: #ffd700; margin-bottom: 15px; }
  .player-card .row { display: flex; justify-content: space-between; flex-wrap: wrap; margin: 5px 0; }
  .player-card .col { flex: 1 1 30%; margin: 3px 0; min-width: 120px; }
  .player-card p { margin: 2px 0; }
</style>
</head>
<body>

<h1>Carte Joueur RPG - Debug</h1>

<div class="input-container">
  <input type="text" id="playerId" placeholder="Entrez l'ID du joueur">
  <button onclick="getPlayer()">Chercher</button>
</div>

<div id="error"></div>
<div id="player" class="player-card" style="display:none;"></div>

<script src="https://cdn.jsdelivr.net/npm/tabletop@1.6.0/src/tabletop.js"></script>
<script>
const sheetId = '1O2abmp1w-IdvbqHXSEXD63Nu6XK4KfJqiOL_8M-i2fA'; // Ton Google Sheet

function safeValue(value) {
  if(value === null || value === undefined || value.toString().trim() === "") return "VIDE";
  return value;
}

function getPlayer() {
  const playerId = document.getElementById('playerId').value.trim();
  const playerDiv = document.getElementById('player');
  const errorDiv = document.getElementById('error');
  playerDiv.style.display = 'none';
  errorDiv.textContent = '';

  if (!playerId) {
    errorDiv.textContent = 'Veuillez entrer un ID.';
    return;
  }

  Tabletop.init({
    key: sheetId,
    simpleSheet: true,
    callback: function(data) {
      const p = data.find(row => row.ID === playerId || row.id === playerId);
      if(!p) {
        errorDiv.textContent = 'Joueur inconnu';
        return;
      }

      console.log("ðŸ”¹ DonnÃ©es reÃ§ues pour l'ID", playerId, ":", p);
      console.log("ðŸ”¹ Toutes les clÃ©s reÃ§ues :", Object.keys(p));

      // Maintenant on peut essayer d'afficher les colonnes connues
      const Nom = safeValue(p.Nom || p.nom);
      const Race = safeValue(p.Race || p.race);
      const Classe = safeValue(p.Classe || p.classe);
      const Niveau = safeValue(p.Niveau || p.niveau);
      const Rang = safeValue(p.Rang || p.rang);
      const Argent = safeValue(p.Argent || p.argent);
      const Victoires = safeValue(p.Victoires || p.victoires);
      const Defaites = safeValue(p.Defaites || p.defaites);
      const Quetes = safeValue(p.Quetes || p.quetes);
      const PV = safeValue(p.PV || p.pv);
      const PM = safeValue(p.PM || p.pm);
      const PF = safeValue(p.PF || p.pf);
      const PE = safeValue(p.PE || p.pe);
      const Vitesse = safeValue(p.Vitesse || p.vitesse);
      const Competence = safeValue(p.Competence || p.competence);
      const Attribut = safeValue(p.Attribut || p.attribut);
      const Familier = safeValue(p.Familier || p.familier);
      const XP = safeValue(p.XP || p.xp);

      playerDiv.innerHTML = `
        <h2>${Nom}</h2>
        <div class="row">
          <div class="col"><strong>Race:</strong> ${Race}</div>
          <div class="col"><strong>Classe:</strong> ${Classe}</div>
          <div class="col"><strong>Niveau:</strong> ${Niveau}</div>
        </div>
        <div class="row">
          <div class="col"><strong>Rang:</strong> ${Rang}</div>
          <div class="col"><strong>Argent:</strong> ${Argent}</div>
          <div class="col"><strong>XP:</strong> ${XP}</div>
        </div>
        <div class="row">
          <div class="col"><strong>Victoires:</strong> ${Victoires}</div>
          <div class="col"><strong>DÃ©faites:</strong> ${Defaites}</div>
          <div class="col"><strong>QuÃªtes:</strong> ${Quetes}</div>
        </div>
        <div class="row">
          <div class="col"><strong>CompÃ©tence:</strong> ${Competence}</div>
          <div class="col"><strong>Attribut:</strong> ${Attribut}</div>
          <div class="col"><strong>Familier:</strong> ${Familier}</div>
        </div>
      `;
      playerDiv.style.display = 'block';
    }
  });
}
</script>

</body>
</html>
